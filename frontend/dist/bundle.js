!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var n,s=i(1),o=i(5),r=new o,h=i(13),a=r.getWidths().then(function(t){var e=document.querySelector("#shelves1");return e.setAttribute("data-segment-widths",JSON.stringify(t)),Promise.resolve()});a.then(function(){function t(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}function e(){n.unbind(),n=new s("#shelves1"),n.start()}n=new s("#shelves1"),n.start(),h();var i=200,o=56,r=t();window.addEventListener("resize",_.debounce(function(i){var n=t(),s=r.width!==n.width,h=Math.abs(r.height-n.height)>o;(s||h)&&(e(),r=n)},i))})},function(t,e,i){"use strict";var n=i(2),s=i(3),o=i(9),r=i(10),h=i(11),a=function(){function t(t){var e=this;this.isDeleted=!1,this.events=new n,this.xMove=0,this.yMove=0,this.frameRequestCallback=function(t){e.onAnimationFrame(t)},this.slideController=new h(this),this.container=document.querySelector(t),this.canvas=this.container.querySelector("canvas"),this.fitCanvas(),this.width=this.canvas.width,this.height=this.canvas.height,this.y=this.container.getBoundingClientRect().top,this.fitPlaceHolder(t),this.container.classList.remove("loading"),this.ctx=this.canvas.getContext("2d"),this.segmentWidths=JSON.parse(this.container.getAttribute("data-segment-widths")),this.segmentHeight=parseInt(this.container.getAttribute("data-segment-height"),10),this.setInitialScale(),this.segments=new s(this,this.segmentWidths,this.initialScale),this.bindControl(),this.hammerManager=r(this)}return t.prototype.getCanvas=function(){return this.canvas},t.prototype.getCanvasContext=function(){return this.ctx},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getXMove=function(){return this.xMove},t.prototype.setXMove=function(t){this.xMove=t},t.prototype.getYMove=function(){return this.yMove},t.prototype.setYMove=function(t){this.yMove=t},t.prototype.getZoomScale=function(){return this.zoomScale},t.prototype.getScale=function(){return this.scale},t.prototype.setScale=function(t){this.scale=t},t.prototype.getY=function(){return this.y},t.prototype.start=function(){window.requestAnimationFrame(this.frameRequestCallback)},t.prototype.onClick=function(t){this.segments.onClick(t)},t.prototype.unbind=function(){this.isDeleted=!0,this.events.removeAllEventListeners(),this.hammerManager.destroy()},t.prototype.fitCanvas=function(){this.canvas.width=document.documentElement.clientWidth;var t=document.documentElement.clientHeight,e=this.container.getBoundingClientRect().top,i=.05*t;this.canvas.height=t-e-i},t.prototype.fitPlaceHolder=function(t){var e=document.querySelector('.shelvesPlaceHolder[data-place-holder-for="'+t+'"]');e.style.height=this.container.getBoundingClientRect().height+"px"},t.prototype.setInitialScale=function(){this.initialScale=this.height/this.segmentHeight;var t=_.max(this.segmentWidths);this.zoomScale=Math.min(this.width/(1.1*t),1),console.log(this.zoomScale),this.scale=this.initialScale},t.prototype.bindControl=function(){var t=this,e=this.container.querySelector(".leftSlideBtn");this.events.addEventListener(e,"click",function(e){e.preventDefault(),t.slideLeft()});var i=this.container.querySelector(".rightSlideBtn");this.events.addEventListener(i,"click",function(e){e.preventDefault(),t.slideRight()});var n=this.container.querySelector(".zoomInBtn");this.events.addEventListener(n,"click",function(e){e.preventDefault(),t.scale+=.01});var s=this.container.querySelector(".zoomOutBtn");this.events.addEventListener(s,"click",function(e){e.preventDefault(),t.scale-=.01})},t.prototype.slideRight=function(){this.slideController.startSlide({distance:-1e3,xMove:this.xMove,timestamp:this.timestamp})},t.prototype.slideLeft=function(){this.slideController.startSlide({distance:1e3,xMove:this.xMove,timestamp:this.timestamp})},t.prototype.onAnimationFrame=function(t){this.timestamp=t,this.blockVerticalMoveOutsideCanvas(),this.slideController.onAnimationFrame(t),this.draw(),o.instance.tick(t),this.isDeleted||window.requestAnimationFrame(this.frameRequestCallback)},t.prototype.draw=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.translate(this.xMove,this.yMove),this.ctx.scale(this.scale,this.scale),this.segments.draw(),this.ctx.restore()},t.prototype.blockVerticalMoveOutsideCanvas=function(){this.yMove=Math.min(0,this.yMove),this.yMove=Math.max(this.yMove,this.height-this.height*(this.scale/this.initialScale))},t}();t.exports=a},function(t,e){var i=function(){function t(){this.eventArgsList=new Array}return t.prototype.addEventListener=function(t,e,i){this.eventArgsList.push({element:t,type:e,listener:i}),t.addEventListener(e,i,!1)},t.prototype.removeAllEventListeners=function(){for(var t=0,e=this.eventArgsList;t<e.length;t++){var i=e[t],n=i.element,s=i.type,o=i.listener;n.removeEventListener(s,o,!1)}},t}();t.exports=i},function(t,e,i){"use strict";var n=i(4),s=i(7),o=i(8),r=function(){function t(t,e,i){this.segments=new Array,this.viewPort=t,this.segmentWidths=e;var n=this.viewPort.getWidth();this.prepender=new s(this.segmentWidths,i),this.appender=new o(n,this.segmentWidths,i)}return t.prototype.onClick=function(t){var e=this.viewPort.getScale();t.x=(t.x-this.viewPort.getXMove())/e,t.y=(t.y-this.viewPort.getYMove()-this.viewPort.getY())/e;for(var i,n=0,s=this.segments;n<s.length;n++){var o=s[n];if(o.isClicked(t)){i=o;break}}i?i.fitOnViewPort(t.y):console.log("brak segmenty klik")},t.prototype.draw=function(){for(var t=0,e=this.segments;t<e.length;t++){var i=e[t];i.draw()}this.preloadSegments()},t.prototype.preloadSegments=function(){var t=this.viewPort.getXMove();if(this.prepender.shouldPrepend(t)){var e=this.prepender.prepend();this.addSegment(e)}if(this.appender.shouldAppend(t)){var e=this.appender.append();this.addSegment(e)}},t.prototype.addSegment=function(t){var e=new n(this.viewPort,t.index,t.x);this.segments.push(e)},t}();t.exports=r},function(t,e,i){"use strict";function n(t){return new Promise(function(e,i){var n=new Image;n.src=t,n.addEventListener("load",function(){e(n)}),n.addEventListener("error",function(t){i(t)})})}var s=i(5),o=new s,r=function(){function t(t,e,i){this.isLoaded=!1,this.index=e,this.viewPort=t,this.ctx=t.getCanvasContext(),this.x=i,this.load(this)}return t.prototype.load=function(t){var e=this;o.getByPosition(this.index).then(function(t){return e.width=t.width,e.height=t.height,e.productPositions=t.productPositions,n(t.spriteImgUrl)}).then(function(i){t.spriteImg=i,e.canvas=e.createCanvas(),t.isLoaded=!0})},t.prototype.draw=function(){this.isLoaded&&this.ctx.drawImage(this.canvas,0,0,this.width,this.height,this.x,0,this.width,this.height)},t.prototype.isClicked=function(t){return t.x>this.x&&t.x<this.x+this.width},t.prototype.fitOnViewPort=function(t){var e=this.viewPort.getWidth(),i=this.viewPort.getHeight(),n=this.viewPort.getZoomScale(),s=(e-this.width*n)/2-this.x*n,o=i/2-t*n;this.viewPort.setXMove(s),this.viewPort.setYMove(o),this.viewPort.setScale(n)},t.prototype.createCanvas=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");e.beginPath(),e.lineWidth=20,e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.lineTo(0,0),e.stroke();for(var i=this.productPositions,n=0;n<i.length;n++){var s=i[n];e.drawImage(this.spriteImg,s.sx,s.sy,s.w,s.h,s.dx,s.dy,s.w,s.h)}return t},t}();t.exports=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i(6),o=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.getWidths=function(){return this.getJson("/getSegmentWidths")},e.prototype.getByPosition=function(t){return this.getJson("/getSegment?index="+t)},e}(s);t.exports=o},function(t,e){"use strict";var i="http://localhost:3000",n=function(){function t(){}return t.prototype.getJson=function(t){return new Promise(function(e,n){var s=new XMLHttpRequest;s.onload=function(t){200===s.status?e(JSON.parse(s.responseText)):n({status:s.status,message:s.responseText})},s.open("get",i+t,!0),s.send()})},t}();t.exports=n},function(t,e){var i=function(){function t(t,e){this.currentIndex=0,this.currentX=0,this.segmentWidths=t,this.segmentCount=t.length,this.initialScale=e}return t.prototype.shouldPrepend=function(t){return t/this.initialScale+this.currentX>0},t.prototype.prepend=function(){this.currentIndex=this.getLastIndexIfBelowZero(this.currentIndex-1);var t=this.segmentWidths[this.currentIndex];return this.currentX-=t,{index:this.currentIndex,x:this.currentX}},t.prototype.getLastIndexIfBelowZero=function(t){return-1===t?this.segmentCount-1:t},t}();t.exports=i},function(t,e){var i=function(){function t(t,e,i){this.nextIndex=0,this.nextX=0,this.canvasWidth=t,this.segmentWidths=e,this.segmentCount=e.length,this.initialScale=i}return t.prototype.shouldAppend=function(t){return t/this.initialScale-this.canvasWidth/this.initialScale+this.nextX<0},t.prototype.append=function(){this.nextIndex=this.getZeroIndexIfUnderLast(this.nextIndex);var t={index:this.nextIndex,x:this.nextX},e=this.segmentWidths[this.nextIndex];return this.nextX+=e,this.nextIndex++,t},t.prototype.getZeroIndexIfUnderLast=function(t){return t===this.segmentCount?0:t},t}();t.exports=i},function(t,e){"use strict";var i=function(){function t(){this.elapsed=0,this.last=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.tick=function(t){this.elapsed=(t-(this.last||t))/1e3,this.last=t},t.prototype.get=function(){return Math.round(1/this.elapsed)},t}();t.exports=i},function(t,e){"use strict";function i(t){var e=new Hammer(t.getCanvas(),{touchAction:"none"});e.get("pan").set({direction:Hammer.DIRECTION_ALL});var i=0,n=0;return e.on("pan",function(e){t.setXMove(t.getXMove()+e.deltaX-i),i=e.deltaX,t.setYMove(t.getYMove()+e.deltaY-n),n=e.deltaY}),e.on("panend",function(t){i=0,n=0}),e.on("tap",function(e){t.onClick(e.center)}),e}t.exports=i},function(t,e,i){var n=i(12),s=function(){function t(t){this.distanceLeft=0,this.xMoveHolder=t}return t.prototype.onAnimationFrame=function(t){if(this.slide){var e=this.slide.animationFrame(t);this.xMoveHolder.setXMove(e.xMove),this.distanceLeft=e.distanceLeft,e.isDone&&(this.slide=null)}},t.prototype.startSlide=function(t){t.distance+=this.distanceLeft,this.slide=new n(t)},t}();t.exports=s},function(t,e){var i=Math.PI/2,n=function(){function t(t){this.DISTANCE=t.distance,this.X_MOVE=t.xMove,this.TIMESTAMP=t.timestamp}return t.prototype.animationFrame=function(t){var e=(t-this.TIMESTAMP)/1e3;if(e>=1)return{xMove:this.X_MOVE+this.DISTANCE,distanceLeft:0,isDone:!0};var n=this.X_MOVE+Math.sin(e*i)*this.DISTANCE;return{xMove:n,distanceLeft:this.DISTANCE-(n-this.X_MOVE),isDone:!1}},t}();t.exports=n},function(t,e,i){function n(){"use strict";function t(){var t=s.instance;n.cur=t.get(),n.min=Math.min(n.min||Number.MAX_VALUE,n.cur),n.max=Math.max(n.max,n.cur),n.max&&(i.textContent="FPS: min."+n.min+" cur."+n.cur+" max."+n.max)}function e(t,e){var i=document.createElement("p");i.textContent=e||t,Modernizr[t]?i.classList.add("green"):i.classList.add("red"),o.appendChild(i)}var i=document.createElement("div");i.classList.add("debugContainer"),i.classList.add("left");var n={min:0,cur:0,max:0};setInterval(t,500);var o=document.createElement("div");o.classList.add("debugContainer"),o.classList.add("right"),e("canvas"),e("requestanimationframe","raf"),e("xhr2"),e("webworkers"),e("transferables"),e("touchevents"),e("eventlistener"),document.body.appendChild(i),document.body.appendChild(o)}var s=i(9);t.exports=n}]);