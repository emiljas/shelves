!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var i,s=n(1),o=n(5),r=new o,h=r.getWidths().then(function(t){var e=document.querySelector("#shelves1");return e.setAttribute("data-segment-widths",JSON.stringify(t)),Promise.resolve()});h.then(function(){function t(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}function e(){i.unbind(),i=s.init("#shelves1"),i.start()}i=s.init("#shelves1"),i.start();var n=200,o=56,r=t();window.addEventListener("resize",_.debounce(function(n){var i=t(),s=r.width!==i.width,h=Math.abs(r.height-i.height)>o;(s||h)&&(e(),r=i)},n))})},function(t,e,n){"use strict";var i=n(2),s=n(3),o=n(9),r=n(10),h=n(11),a=function(){function t(){var t=this;this.isDeleted=!1,this.events=new i,this.frameRequestCallback=function(e){t.onAnimationFrame(e)},this.slideController=new h(this)}return t.init=function(e){var n=new t;window.vp=n;var i=document.querySelector(e);n.container=i;var o=i.querySelector("canvas");n.canvas=o,function(){o.width=document.documentElement.clientWidth;var t=document.documentElement.clientHeight,e=i.getBoundingClientRect().top,n=.05*t;o.height=t-e-n}(),n.width=o.width,n.height=o.height,function(){var t=document.querySelector('.shelvesPlaceHolder[data-place-holder-for="'+e+'"]');t.style.height=i.getBoundingClientRect().height+"px"}(),i.classList.remove("loading"),n.ctx=n.canvas.getContext("2d"),n.timestamp=0,n.xMove=0,n.yMove=0,n.distanceToMove=0;var h=JSON.parse(i.getAttribute("data-segment-widths")),a=parseInt(i.getAttribute("data-segment-height"),10);!function(){n.initialScale=n.height/a;var t=_.max(h);n.zoomScale=Math.min(.3,n.width/t),n.scale=n.initialScale}(),n.segments=new s(n,h,n.initialScale);var c=i.querySelector(".leftSlideBtn");n.events.addEventListener(c,"click",function(t){t.preventDefault(),n.slideLeft()});var u=i.querySelector(".rightSlideBtn");n.events.addEventListener(u,"click",function(t){t.preventDefault(),n.slideRight()});var d=i.querySelector(".zoomInBtn");n.events.addEventListener(d,"click",function(t){t.preventDefault(),n.scale+=.01});var p=i.querySelector(".zoomOutBtn");return n.events.addEventListener(p,"click",function(t){t.preventDefault(),n.scale-=.01}),n.hammerManager=r(n),n},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getCanvasContext=function(){return this.ctx},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getXMove=function(){return this.xMove},t.prototype.setXMove=function(t){this.xMove=t},t.prototype.getYMove=function(){return this.yMove},t.prototype.setYMove=function(t){this.yMove=t},t.prototype.getZoomScale=function(){return this.zoomScale},t.prototype.getScale=function(){return this.scale},t.prototype.setScale=function(t){this.scale=t},t.prototype.start=function(){window.requestAnimationFrame(this.frameRequestCallback)},t.prototype.onClick=function(t){this.segments.onClick(t)},t.prototype.unbind=function(){this.isDeleted=!0,this.events.removeAllEventListeners(),this.hammerManager.destroy()},t.prototype.slideRight=function(){this.slideController.startSlide({distance:-1e3,xMove:this.xMove,timestamp:this.timestamp})},t.prototype.slideLeft=function(){this.slideController.startSlide({distance:1e3,xMove:this.xMove,timestamp:this.timestamp})},t.prototype.onAnimationFrame=function(t){this.timestamp=t,this.yMove=Math.min(0,this.yMove),this.yMove=Math.max(this.yMove,this.height-this.height*(this.scale/this.initialScale)),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.slideController.onAnimationFrame(t),this.ctx.save(),this.ctx.translate(this.xMove,this.yMove),this.ctx.scale(this.scale,this.scale),this.segments.draw(),this.ctx.restore(),this.lastTimestamp=t,o.instance.tick(t),this.isDeleted||window.requestAnimationFrame(this.frameRequestCallback)},t}();t.exports=a},function(t,e){var n=function(){function t(){this.eventArgsList=new Array}return t.prototype.addEventListener=function(t,e,n){this.eventArgsList.push({element:t,type:e,listener:n}),t.addEventListener(e,n,!1)},t.prototype.removeAllEventListeners=function(){for(var t=0,e=this.eventArgsList;t<e.length;t++){var n=e[t],i=n.element,s=n.type,o=n.listener;i.removeEventListener(s,o,!1)}},t}();t.exports=n},function(t,e,n){"use strict";var i=n(4),s=n(7),o=n(8),r=function(){function t(t,e,n){this.segments=new Array,this.viewPort=t,this.segmentWidths=e;var i=this.viewPort.getWidth();this.prepender=new s(this.segmentWidths,n),this.appender=new o(i,this.segmentWidths,n)}return t.prototype.onClick=function(t){var e=this.viewPort.getScale();t.x-=this.viewPort.getXMove(),t.x/=e,t.y/=e;for(var n,i=0,s=this.segments;i<s.length;i++){var o=s[i];if(o.isClicked(t)){n=o;break}}n?n.fitOnViewPort():console.log("brak segmenty klik")},t.prototype.draw=function(){for(var t=0,e=this.segments;t<e.length;t++){var n=e[t];n.draw()}this.preloadSegments()},t.prototype.preloadSegments=function(){var t=this.viewPort.getXMove();if(this.prepender.shouldPrepend(t)){var e=this.prepender.prepend();this.addSegment(e)}if(this.appender.shouldAppend(t)){var e=this.appender.append();this.addSegment(e)}},t.prototype.addSegment=function(t){var e=new i(this.viewPort,t.index,t.x);this.segments.push(e)},t}();t.exports=r},function(t,e,n){"use strict";function i(t){return new Promise(function(e,n){var i=new Image;i.src=t,i.addEventListener("load",function(){e(i)}),i.addEventListener("error",function(t){n(t)})})}var s=n(5),o=new s,r=function(){function t(t,e,n){this.isLoaded=!1,this.index=e,this.viewPort=t,this.ctx=t.getCanvasContext(),this.x=n,this.load(this)}return t.prototype.load=function(t){var e=this;o.getByPosition(this.index).then(function(t){return e.width=t.width,e.height=t.height,e.productPositions=t.productPositions,i(t.spriteImgUrl)}).then(function(n){t.spriteImg=n,e.canvas=e.createCanvas(),t.isLoaded=!0})},t.prototype.draw=function(){this.isLoaded&&this.ctx.drawImage(this.canvas,0,0,this.width,this.height,this.x,0,this.width,this.height)},t.prototype.isClicked=function(t){return t.x>this.x&&t.x<this.x+this.width},t.prototype.fitOnViewPort=function(){var t=this.viewPort.getWidth(),e=this.viewPort.getZoomScale(),n=(t-this.width*e)/2-this.x*e;this.viewPort.setXMove(n),this.viewPort.setScale(e)},t.prototype.createCanvas=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");e.beginPath(),e.lineWidth=20,e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.lineTo(0,0),e.stroke();for(var n=this.productPositions,i=0;i<n.length;i++){var s=n[i];0!==s.h&&e.drawImage(this.spriteImg,s.sx,s.sy,s.w,s.h,s.dx,s.dy,s.w,s.h)}return t},t}();t.exports=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=n(6),o=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.getWidths=function(){return this.getJson("/getSegmentWidths")},e.prototype.getByPosition=function(t){return this.getJson("/getSegment?index="+t)},e}(s);t.exports=o},function(t,e){"use strict";var n="http://localhost:3000",i=function(){function t(){}return t.prototype.getJson=function(t){return new Promise(function(e,i){var s=new XMLHttpRequest;s.onload=function(t){200===s.status?e(JSON.parse(s.responseText)):i({status:s.status,message:s.responseText})},s.open("get",n+t,!0),s.send()})},t}();t.exports=i},function(t,e){var n=function(){function t(t,e){this.currentIndex=0,this.currentX=0,this.segmentWidths=t,this.segmentCount=t.length,this.initialScale=e}return t.prototype.shouldPrepend=function(t){return t/this.initialScale+this.currentX>0},t.prototype.prepend=function(){this.currentIndex=this.getLastIndexIfBelowZero(this.currentIndex-1);var t=this.segmentWidths[this.currentIndex];return this.currentX-=t,{index:this.currentIndex,x:this.currentX}},t.prototype.getLastIndexIfBelowZero=function(t){return-1===t?this.segmentCount-1:t},t}();t.exports=n},function(t,e){var n=function(){function t(t,e,n){this.nextIndex=0,this.nextX=0,this.canvasWidth=t,this.segmentWidths=e,this.segmentCount=e.length,this.initialScale=n}return t.prototype.shouldAppend=function(t){return t/this.initialScale-this.canvasWidth/this.initialScale+this.nextX<0},t.prototype.append=function(){this.nextIndex=this.getZeroIndexIfUnderLast(this.nextIndex);var t={index:this.nextIndex,x:this.nextX},e=this.segmentWidths[this.nextIndex];return this.nextX+=e,this.nextIndex++,t},t.prototype.getZeroIndexIfUnderLast=function(t){return t===this.segmentCount?0:t},t}();t.exports=n},function(t,e){"use strict";var n=function(){function t(){this.elapsed=0,this.last=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.tick=function(t){this.elapsed=(t-(this.last||t))/1e3,this.last=t},t.prototype.get=function(){return Math.round(1/this.elapsed)},t}();t.exports=n},function(t,e){"use strict";function n(t){var e=new Hammer(t.getCanvas(),{touchAction:"none"});e.get("pan").set({direction:Hammer.DIRECTION_ALL});var n=0,i=0;return e.on("pan",function(e){t.setXMove(t.getXMove()+e.deltaX-n),n=e.deltaX,t.setYMove(t.getYMove()+e.deltaY-i),i=e.deltaY}),e.on("panend",function(t){n=0,i=0}),e.on("tap",function(e){t.onClick(e.center)}),e}t.exports=n},function(t,e,n){var i=n(12),s=function(){function t(t){this.distanceLeft=0,this.xMoveHolder=t}return t.prototype.onAnimationFrame=function(t){if(this.slide){var e=this.slide.animationFrame(t);this.xMoveHolder.setXMove(e.xMove),this.distanceLeft=e.distanceLeft,e.isDone&&(this.slide=null)}},t.prototype.startSlide=function(t){t.distance+=this.distanceLeft,this.slide=new i(t)},t}();t.exports=s},function(t,e){var n=Math.PI/2,i=function(){function t(t){this.DISTANCE=t.distance,this.X_MOVE=t.xMove,this.TIMESTAMP=t.timestamp}return t.prototype.animationFrame=function(t){var e=(t-this.TIMESTAMP)/1e3;if(e>=1)return{xMove:this.X_MOVE+this.DISTANCE,distanceLeft:0,isDone:!0};var i=this.X_MOVE+Math.sin(e*n)*this.DISTANCE;return{xMove:i,distanceLeft:this.DISTANCE-(i-this.X_MOVE),isDone:!1}},t}();t.exports=i}]);