!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var i=n(1),s=n(4),o=new s,r=o.getWidths().then(function(t){for(var e=document.querySelectorAll("canvas"),n=0;n<e.length;n++){var i=e[n];i.setAttribute("data-segment-widths",JSON.stringify(t))}return Promise.resolve()});r.then(function(){var t=i.init("#shelves1");t.start()})},function(t,e,n){"use strict";var i=n(2),s=n(8),o=n(9),r=n(10),h=function(){function t(){var t=this;this.scale=.33,this.frameRequestCallback=function(e){t.loop(e)},this.slideController=new r(this)}return t.init=function(e){var n=new t,s=document.querySelector(e);n.container=s,n.canvas=s.querySelector("canvas"),n.width=n.canvas.width,n.height=n.canvas.height,n.ctx=n.canvas.getContext("2d"),n.timestamp=0,n.xMove=0,n.yMove=0,n.distanceToMove=0,n.segments=new i(n);var r=s.querySelector(".rightSlideBtn");return r.addEventListener("click",function(){n.slideRight()},!1),o(n),n},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getCanvasContext=function(){return this.ctx},t.prototype.getWidth=function(){return this.width},t.prototype.getXMove=function(){return this.xMove},t.prototype.setXMove=function(t){this.xMove=t},t.prototype.getYMove=function(){return this.yMove},t.prototype.setYMove=function(t){this.yMove=t},t.prototype.getScale=function(){return this.scale},t.prototype.setScale=function(t){this.scale=t},t.prototype.start=function(){window.requestAnimationFrame(this.frameRequestCallback)},t.prototype.slideRight=function(){this.slideController.startSlide({distance:1e3,xMove:this.xMove,timestamp:this.timestamp})},t.prototype.loop=function(t){this.timestamp=t,this.yMove=Math.min(0,this.yMove),this.yMove=Math.max(this.yMove,this.height-this.height*(this.scale/.33)),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.slideController.onAnimationFrame(t),this.ctx.save(),this.ctx.translate(this.xMove,this.yMove),this.ctx.scale(this.scale,this.scale),this.segments.draw(),this.ctx.restore(),this.lastTimestamp=t,s.instance.tick(t),window.requestAnimationFrame(this.frameRequestCallback)},t}();t.exports=h},function(t,e,n){"use strict";var i=n(3),s=n(6),o=n(7),r=function(){function t(t){this.segments=new Array,this.viewPort=t,this.segmentWidths=JSON.parse(t.getCanvas().getAttribute("data-segment-widths")),this.prepender=new s(this.segmentWidths),this.appender=new o(this.segmentWidths)}return t.prototype.draw=function(){for(var t=0,e=this.segments;t<e.length;t++){var n=e[t];n.draw()}this.preloadSegments()},t.prototype.preloadSegments=function(){var t=this.viewPort.getXMove(),e=this.viewPort.getWidth();if(this.prepender.shouldPrepend(t)){var n=this.prepender.prepend();this.addSegment(n),console.log("prepend")}if(this.appender.shouldAppend(t,e)){var n=this.appender.append();this.addSegment(n),console.log("append")}},t.prototype.addSegment=function(t){var e=new i(this.viewPort,t.index,t.x);this.segments.push(e)},t}();t.exports=r},function(t,e,n){"use strict";function i(t){return new Promise(function(e,n){var i=new Image;i.src=t,i.addEventListener("load",function(){e(i)}),i.addEventListener("error",function(t){n(t)})})}var s=n(4),o=new s,r=function(){function t(t,e,n){this.isLoaded=!1,this.index=e,this.viewPort=t,this.ctx=t.getCanvasContext(),this.x=n,this.load(this)}return t.prototype.load=function(t){var e=this;o.getByPosition(this.index).then(function(t){return e.width=t.width,e.height=t.height,e.productPositions=t.productPositions,i(t.spriteImgUrl)}).then(function(e){t.spriteImg=e,t.isLoaded=!0})},t.prototype.draw=function(){if(this.isLoaded){this.ctx.beginPath(),this.ctx.lineWidth=20,this.ctx.moveTo(this.x,0),this.ctx.lineTo(this.x+this.width,0),this.ctx.lineTo(this.x+this.width,this.height),this.ctx.lineTo(this.x,this.height),this.ctx.lineTo(this.x,0),this.ctx.stroke();for(var t=this.spriteImg,e=this.productPositions,n=0;n<e.length;n++){var i=e[n];0!==i.h&&this.ctx.drawImage(t,i.sx,i.sy,i.w,i.h,i.dx+this.x,i.dy,i.w,i.h)}}},t}();t.exports=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=n(5),o=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.getWidths=function(){return this.getJson("/getSegmentWidths")},e.prototype.getByPosition=function(t){return this.getJson("/getSegment?index="+t)},e}(s);t.exports=o},function(t,e){"use strict";var n="http://localhost:3000",i=function(){function t(){}return t.prototype.getJson=function(t){return new Promise(function(e,i){var s=new XMLHttpRequest;s.onload=function(t){200===s.status?e(JSON.parse(s.responseText)):i({status:s.status,message:s.responseText})},s.open("get",n+t,!0),s.send()})},t}();t.exports=i},function(t,e){var n=function(){function t(t){this.currentIndex=0,this.currentX=0,this.segmentWidths=t,this.segmentCount=t.length}return t.prototype.shouldPrepend=function(t){return 3*t+this.currentX>0},t.prototype.prepend=function(){this.currentIndex=this.getLastIndexIfBelowZero(this.currentIndex-1);var t=this.segmentWidths[this.currentIndex];return this.currentX-=t,{index:this.currentIndex,x:this.currentX}},t.prototype.getLastIndexIfBelowZero=function(t){return-1===t?this.segmentCount-1:t},t}();t.exports=n},function(t,e){var n=function(){function t(t){this.nextIndex=0,this.nextX=0,this.segmentWidths=t,this.segmentCount=t.length}return t.prototype.shouldAppend=function(t,e){return 3*t-3*e+this.nextX<0},t.prototype.append=function(){this.nextIndex=this.getZeroIndexIfUnderLast(this.nextIndex);var t={index:this.nextIndex,x:this.nextX},e=this.segmentWidths[this.nextIndex];return this.nextX+=e,this.nextIndex++,t},t.prototype.getZeroIndexIfUnderLast=function(t){return t===this.segmentCount?0:t},t}();t.exports=n},function(t,e){"use strict";var n=function(){function t(){this.elapsed=0,this.last=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.tick=function(t){this.elapsed=(t-(this.last||t))/1e3,this.last=t},t.prototype.get=function(){return Math.round(1/this.elapsed)},t}();t.exports=n},function(t,e){"use strict";function n(t){var e=new Hammer(t.getCanvas(),{touchAction:"none"});e.get("pan").set({direction:Hammer.DIRECTION_ALL});var n=0,i=0;e.on("pan",function(e){t.setXMove(t.getXMove()+e.deltaX-n),n=e.deltaX,t.setYMove(t.getYMove()+e.deltaY-i),i=e.deltaY}),e.on("panend",function(t){n=0,i=0}),e.on("tap",function(){.33===t.getScale()?t.setScale(1):t.setScale(.33)})}t.exports=n},function(t,e,n){var i=n(11),s=function(){function t(t){this.viewPort=t}return t.prototype.onAnimationFrame=function(t){if(this.slide){var e=this.slide.calcXMove(t);this.viewPort.setXMove(e),this.slide.IsDone()&&(this.slide=null)}},t.prototype.startSlide=function(t){this.slide||(this.slide=new i(t))},t}();t.exports=s},function(t,e){var n=function(){function t(t){this.isDone=!1,this.distance=t.distance,this.xMove=t.xMove,this.startTimeStamp=t.timestamp}return t.prototype.IsDone=function(){return this.isDone},t.prototype.calcXMove=function(t){var e=(t-this.startTimeStamp)/1e3,n=Math.sin(e*(Math.PI/2))*this.distance;return e>=.95&&(this.isDone=!0,console.log("DONE!")),this.xMove+=n,this.distance-=n,this.xMove},t}();t.exports=n}]);
//# sourceMappingURL=bundle.js.map