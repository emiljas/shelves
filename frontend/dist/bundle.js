!function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return t[a].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var a=n(1),i=n(4),o=n(7),s=n(8),u=n(9),d=n(11);i["default"].init("#shelvesCanvas1"),a["default"].init().then(function(){console.log(a["default"].segmentWidths),o["default"](),s["default"](),i["default"].instance.start(),_.times(5,function(){u["default"].appendSegment()}),u["default"].prependSegment(),d["default"]()});var r=.7,c=document.getElementById("backBtn");c.addEventListener("click",function(){var t=a["default"].distanceToMove+a["default"].canvasWidth*r;i["default"].instance.moveX(t)},!1);var l=document.getElementById("nextBtn");l.addEventListener("click",function(){var t=a["default"].distanceToMove-a["default"].canvasWidth*r;i["default"].instance.moveX(t)},!1)},function(t,e,n){"use strict";var a=n(2),i=new a["default"],o=function(){function t(){}return Object.defineProperty(t,"segmentWidths",{get:function(){return t._segmentWidths},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SEGMENT_HEIGHT",{get:function(){return 1920},enumerable:!0,configurable:!0}),t.init=function(){return t.canvas=document.getElementById("shelvesCanvas"),t.canvasWidth=t.canvas.width,t.canvasHeight=t.canvas.height,t.ctx=t.canvas.getContext("2d"),t.timestamp=0,t.xMove=0,t.yMove=0,t.distanceToMove=0,i.getWidths().then(function(e){return t._segmentWidths=e,Promise.resolve()})},t.segments=new Array,t.scale=.33,t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o},function(t,e,n){"use strict";var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(3),o=function(t){function e(){t.apply(this,arguments)}return a(e,t),e.prototype.getWidths=function(){return this.getJson("/getSegmentWidths")},e.prototype.getByPosition=function(t){return this.getJson("/getSegment?position="+t)},e}(i["default"]);Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o},function(t,e){"use strict";var n="http://localhost:3000",a=function(){function t(){}return t.prototype.getJson=function(t){return new Promise(function(e,a){var i=new XMLHttpRequest;i.onload=function(t){200==i.status?e(JSON.parse(i.responseText)):a({status:i.status,message:i.responseText})},i.open("get",n+t,!0),i.send()})},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a},function(t,e,n){"use strict";function a(t){return Math.abs(t)<d}var i=n(1),o=n(9),s=n(6),u=function(){function t(){var t=this;this.loop=function(e){if(i["default"].timestamp=e,i["default"].yMove=Math.min(0,i["default"].yMove),i["default"].yMove=Math.max(i["default"].yMove,i["default"].canvasHeight-i["default"].canvasHeight*(i["default"].scale/.33)),i["default"].ctx.clearRect(0,0,i["default"].canvas.width,i["default"].canvas.height),!a(i["default"].distanceToMove)){var n=(i["default"].timestamp-t.animationTimestamp)/1e3,u=Math.sin(n)*i["default"].distanceToMove;i["default"].xMove+=u,i["default"].distanceToMove-=u}i["default"].ctx.save(),i["default"].ctx.translate(i["default"].xMove,i["default"].yMove),i["default"].ctx.scale(i["default"].scale,i["default"].scale);for(var d=0,r=i["default"].segments;d<r.length;d++){var c=r[d];c.draw()}o["default"].preloadSegments(),i["default"].ctx.restore(),i["default"].lastTimestamp=e,s["default"].instance.tick(e),window.requestAnimationFrame(t.loop)}}return Object.defineProperty(t,"instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),t.init=function(e){return i["default"].canvas=document.getElementById("canvas"),new t},t.prototype.start=function(){window.requestAnimationFrame(this.loop)},t.prototype.moveX=function(t){this.animationTimestamp=i["default"].timestamp,i["default"].distanceToMove=t},t._instance=new t,t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=u;var d=.5},,function(t,e){"use strict";var n=function(){function t(){this.elapsed=0,this.last=null}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.tick=function(t){this.elapsed=(t-(this.last||t))/1e3,this.last=t},t.prototype.get=function(){return Math.round(1/this.elapsed)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e,n){"use strict";function a(){var t=document.getElementById("shelvesCanvasContainer");o["default"].canvas.width=t.offsetWidth,o["default"].canvas.height=o["default"].SEGMENT_HEIGHT*o["default"].scale,o["default"].canvasWidth=o["default"].canvas.width,o["default"].canvasHeight=o["default"].canvas.height}function i(){window.addEventListener("resize",_.debounce(function(t){a()},s)),a()}var o=n(1),s=500;Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=i},function(t,e,n){"use strict";function a(){var t=new Hammer(i["default"].canvas,{touchAction:"none"});t.get("pan").set({direction:Hammer.DIRECTION_ALL});var e=0,n=0;t.on("pan",function(t){i["default"].xMove+=t.deltaX-e,e=t.deltaX,i["default"].yMove+=t.deltaY-n,n=t.deltaY}),t.on("panend",function(t){e=0,n=0}),t.on("tap",function(){.33==i["default"].scale?i["default"].scale=1:i["default"].scale=.33})}var i=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a},function(t,e,n){"use strict";function a(t){return new Promise(function(e,n){var a=new Image;a.src=t,a.addEventListener("load",function(){e(a)}),a.addEventListener("error",function(t){n(t)})})}var i=n(1),o=n(2),s=n(10),u=new o["default"],d=50,r=function(){function t(t){this.isLoaded=!1,this.position=t,i["default"].segments.push(this)}return t.preloadSegments=function(){3*i["default"].xMove+t.backX>0&&t.prependSegment(),3*i["default"].xMove-3*i["default"].canvasWidth+t.frontX<0&&t.appendSegment()},t.prependSegment=function(){var e=s["default"](t.backPosition--,300),n=new t(e),a=i["default"].segmentWidths[e-1];t.backX-=a+d,n.x=t.backX,n.load(n)},t.appendSegment=function(){var e=s["default"](t.frontPosition++,300),n=new t(e);n.x=t.frontX;var a=i["default"].segmentWidths[e-1];t.frontX+=a+d,n.load(n)},t.prototype.load=function(t){u.getByPosition(this.position).then(function(e){return t.data=e,a(e.spriteImgUrl)}).then(function(e){t.spriteImg=e,t.isLoaded=!0})},t.prototype.draw=function(){if(this.isLoaded){i["default"].ctx.beginPath(),i["default"].ctx.lineWidth=6,i["default"].ctx.moveTo(this.x,0),i["default"].ctx.lineTo(this.x+this.data.width,0),i["default"].ctx.lineTo(this.x+this.data.width,this.data.height),i["default"].ctx.lineTo(this.x,this.data.height),i["default"].ctx.lineTo(this.x,0),i["default"].ctx.stroke();for(var t=this.spriteImg,e=this.data.productPositions,n=0;n<e.length;n++){var a=e[n];0!==a.h&&i["default"].ctx.drawImage(t,a.sx,a.sy,a.w,a.h,a.dx+this.x,a.dy,a.w,a.h)}}},t.backPosition=0,t.backX=0,t.frontPosition=1,t.frontX=0,t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r},function(t,e){function n(t,e){return 1>t?e+t%e:t>e?t%e:t}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e,n){"use strict";function a(){function t(t,e){var n=document.createElement("p");n.textContent=e||t,Modernizr[t]?n.classList.add("green"):n.classList.add("red"),a.appendChild(n)}var e=document.createElement("div");e.classList.add("debugContainer"),e.classList.add("left");var n={min:0,cur:0,max:0};setInterval(function(){var t=i["default"].instance;n.cur=t.get(),n.min=Math.min(n.min||Number.MAX_VALUE,n.cur),n.max=Math.max(n.max,n.cur),n.max&&(e.textContent="FPS: min."+n.min+" cur."+n.cur+" max."+n.max)},500);var a=document.createElement("div");a.classList.add("debugContainer"),a.classList.add("right"),t("canvas"),t("requestanimationframe","raf"),t("xhr2"),t("webworkers"),t("transferables"),t("touchevents"),t("eventlistener"),document.body.appendChild(e),document.body.appendChild(a)}var i=n(6);Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a}]);